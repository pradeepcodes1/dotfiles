#!/bin/sh
set -e

# Function: Initialize brew environment
setup_brew_env() {
  if [ -x "/opt/homebrew/bin/brew" ]; then
    eval "$(/opt/homebrew/bin/brew shellenv)"
  elif [ -x "/home/linuxbrew/.linuxbrew/bin/brew" ]; then
    eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
  fi
}

setup_brew_env

# Check if brew is available
if command -v brew >/dev/null 2>&1; then
  echo "✅ Running brew bundle..."
  brew bundle --file="$HOME/.config/brew/packages"
elif [ -x "/opt/homebrew/bin/brew" ]; then
  echo "✅ Running brew bundle..."
  /opt/homebrew/bin/brew bundle --file="$HOME/.config/brew/packages"
else
  echo "⚠️  Homebrew not found, skipping brew bundle"
fi
